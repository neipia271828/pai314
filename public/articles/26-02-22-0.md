---
title: Codex CLIでmulti-agent運用を始める実践ガイド
date: 2026-02-22
summary: Codex CLIを使って、調査・実装・レビューを並列化するmulti-agent運用の基本手順と実践ポイントを解説します。
id: 26-02-22-0
tags:
  - codex-cli
  - multi-agent
  - workflow
---

## はじめに

大きめの実装タスクを1つのエージェントだけで進めると、
「調査しながら実装し、同時にレビュー観点も考える」状態になりがちです。

そこで有効なのが **multi-agent運用** です。
本記事では、Codex CLIを中心に、役割を分けて並列に進める実践フローを紹介します。

## multi-agentで分けるべき役割

最初は次の3役に分けるだけで十分です。

1. **Explorer（調査担当）**
   - 既存コードや依存関係、影響範囲を調べる
2. **Worker（実装担当）**
   - 変更を加え、テストを通す
3. **Reviewer（検証担当）**
   - 要件適合、リグレッション、テスト不足をチェックする

この分割により、探索と実装が詰まる時間を減らせます。

## 進め方の全体像

1. Leadが要件を短く固定する（Must / Should / Out of scope）
2. Explorerに調査だけを依頼する
3. Workerに実装を依頼する（Explorer結果を入力として渡す）
4. Reviewerに差分レビューを依頼する
5. Leadが最終判断してマージする

ポイントは、各エージェントに「やってよいこと・禁止事項」を先に明示することです。

## Codex CLIでの実行例

### 1) Explorerを先に走らせる

```bash
codex exec --full-auto "\
あなたはExplorerです。実装はせず、以下だけを報告してください。\
- 影響ファイル\
- 既存ロジックの要点\
- 破壊的変更リスク\
- 追加テスト候補\
"
```

### 2) Workerに実装させる

```bash
codex exec --full-auto "\
あなたはWorkerです。Explorerの調査結果に基づき、最小変更で実装してください。\
- 不要なリファクタ禁止\
- 変更ファイルごとに理由を記録\
- lint/build/testを実行して結果を報告\
"
```

### 3) Reviewerで仕上げる

```bash
codex exec --full-auto "\
あなたはReviewerです。差分をレビューし、\
- バグ\
- 要件未達\
- テスト不足\
を重大度順に列挙してください。\
問題がなければ承認理由を簡潔にまとめてください。\
"
```

## 失敗しないための運用ルール

- **ルール1: 役割を混ぜない**
  - Explorerに実装をさせない、Workerに要件変更をさせない
- **ルール2: 出力フォーマットを固定する**
  - 例: `Summary / Changed Files / Verification / Risks`
- **ルール3: 並列化は独立タスクだけ**
  - 同じファイルを同時編集させると競合しやすい
- **ルール4: 最終責任はLeadが持つ**
  - エージェント出力は提案。最終判断は必ず人間が行う

## どのタスクで効果が大きいか

multi-agent運用は次の場面で特に効果的です。

- 変更対象が複数ディレクトリにまたがるとき
- 調査と実装を並列に進めたいとき
- リリース前にレビュー品質を上げたいとき

逆に、小さな1ファイル修正は単一エージェントのほうが速いこともあります。

## まとめ

Codex CLIのmulti-agent運用は、
**「役割分担」「出力フォーマット固定」「Leadによる最終判断」** の3点を守るだけで安定します。

まずは Explorer / Worker / Reviewer の3役から始め、
慣れてきたらテスト専任エージェントを追加していくのがおすすめです。
